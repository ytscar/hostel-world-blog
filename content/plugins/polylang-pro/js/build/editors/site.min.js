(()=>{var t={20:(t,e,n)=>{"use strict";var s=n(677),o=Symbol.for("react.element"),r=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,i=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(t,e,n){var s,r={},c=null,p=null;for(s in void 0!==n&&(c=""+n),void 0!==e.key&&(c=""+e.key),void 0!==e.ref&&(p=e.ref),e)a.call(e,s)&&!l.hasOwnProperty(s)&&(r[s]=e[s]);if(t&&t.defaultProps)for(s in e=t.defaultProps)void 0===r[s]&&(r[s]=e[s]);return{$$typeof:o,type:t,key:c,ref:p,props:r,_owner:i.current}}e.Fragment=r,e.jsx=c,e.jsxs=c},848:(t,e,n)=>{"use strict";t.exports=n(20)},677:t=>{t.exports=function(){return this.React}()},419:t=>{t.exports=function(){return this.lodash}()},631:t=>{t.exports=function(){return this.wp.apiFetch}()},959:t=>{t.exports=function(){return this.wp.components}()},897:t=>{t.exports=function(){return this.wp.compose}()},488:t=>{t.exports=function(){return this.wp.coreData}()},987:t=>{t.exports=function(){return this.wp.data}()},324:t=>{t.exports=function(){return this.wp.editSite}()},601:t=>{t.exports=function(){return this.wp.element}()},75:t=>{t.exports=function(){return this.wp.i18n}()},860:t=>{t.exports=function(){return this.wp.keycodes}()},672:t=>{t.exports=function(){return this.wp.notices}()},125:t=>{t.exports=function(){return this.wp.plugins}()},933:t=>{t.exports=function(){return this.wp.primitives}()},172:t=>{t.exports=function(){return this.wp.url}()},942:(t,e)=>{var n;!function(){"use strict";var s={}.hasOwnProperty;function o(){for(var t="",e=0;e<arguments.length;e++){var n=arguments[e];n&&(t=a(t,r(n)))}return t}function r(t){if("string"==typeof t||"number"==typeof t)return t;if("object"!=typeof t)return"";if(Array.isArray(t))return o.apply(null,t);if(t.toString!==Object.prototype.toString&&!t.toString.toString().includes("[native code]"))return t.toString();var e="";for(var n in t)s.call(t,n)&&t[n]&&(e=a(e,n));return e}function a(t,e){return e?t?t+" "+e:t+e:t}t.exports?(o.default=o,t.exports=o):void 0===(n=function(){return o}.apply(e,[]))||(t.exports=n)}()}},e={};function n(s){var o=e[s];if(void 0!==o)return o.exports;var r=e[s]={exports:{}};return t[s](r,r.exports,n),r.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var s in e)n.o(e,s)&&!n.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);(()=>{"use strict";var t=n(324),e=n(125),s=n(933),o=n(848);void 0!==wp.primitives&&(s.SVG,s.Path);const r=void 0!==wp.primitives?(0,o.jsx)(s.SVG,{width:"20",height:"20",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:(0,o.jsx)(s.Path,{d:"M13.89 3.39l2.71 2.72c0.46 0.46 0.42 1.24 0.030 1.64l-8.010 8.020-5.56 1.16 1.16-5.58s7.6-7.63 7.99-8.030c0.39-0.39 1.22-0.39 1.68 0.070zM11.16 6.18l-5.59 5.61 1.11 1.11 5.54-5.65zM8.19 14.41l5.58-5.6-1.070-1.080-5.59 5.6z"})}):"edit",a=void 0!==wp.primitive?(0,o.jsx)(s.SVG,{width:"20",height:"20",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:(0,o.jsx)(s.Path,{d:"M17 7v3h-5v5h-3v-5h-5v-3h5v-5h3v5h5z"})}):"plus",i=void 0!==wp.primitives?(0,o.jsx)(s.SVG,{width:"20",height:"20",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:(0,o.jsx)(s.Path,{d:"M5 7v3l-2 1.5v-6.5h11v-2l4 3.010-4 2.99v-2h-9zM15 13v-3l2-1.5v6.5h-11v2l-4-3.010 4-2.99v2h9z"})}):"controls-repeat",l=void 0!==wp.primitives?(0,o.jsx)(s.SVG,{width:"20",height:"20",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:(0,o.jsx)(s.Path,{d:"M11 7H9.49c-.63 0-1.25.3-1.59.7L7 5H4.13l-2.39 7h1.69l.74-2H7v4H2c-1.1 0-2-.9-2-2V5c0-1.1.9-2 2-2h7c1.1 0 2 .9 2 2v2zM6.51 9H4.49l1-2.93zM10 8h7c1.1 0 2 .9 2 2v7c0 1.1-.9 2-2 2h-7c-1.1 0-2-.9-2-2v-7c0-1.1.9-2 2-2zm7.25 5v-1.08h-3.17V9.75h-1.16v2.17H9.75V13h1.28c.11.85.56 1.85 1.28 2.62-.87.36-1.89.62-2.31.62-.01.02.22.97.2 1.46.84 0 2.21-.5 3.28-1.15 1.09.65 2.48 1.15 3.34 1.15-.02-.49.2-1.44.2-1.46-.43 0-1.49-.27-2.38-.63.7-.77 1.14-1.77 1.25-2.61h1.36zm-3.81 1.93c-.5-.46-.85-1.13-1.01-1.93h2.09c-.17.8-.51 1.47-1 1.93l-.04.03s-.03-.02-.04-.03z"})}):"translation",c=void 0!==wp.primitives?(0,o.jsx)(s.SVG,{width:"20",height:"20",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:(0,o.jsx)(s.Path,{d:"M12 4h3c.6 0 1 .4 1 1v1H3V5c0-.6.5-1 1-1h3c.2-1.1 1.3-2 2.5-2s2.3.9 2.5 2zM8 4h3c-.2-.6-.9-1-1.5-1S8.2 3.4 8 4zM4 7h11l-.9 10.1c0 .5-.5.9-1 .9H5.9c-.5 0-.9-.4-1-.9L4 7z"})}):"trash",p=void 0!==wp.primitives?(0,o.jsx)(s.SVG,{width:"20",height:"20",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:(0,o.jsx)(s.Path,{d:"m10 1 3 6 6 .75-4.12 4.62L16 19l-6-3-6 3 1.13-6.63L1 7.75 7 7z"})}):"star-filled";wp.primitives;var u=n(959),d=n(75);const g=()=>(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(u.Icon,{icon:p,className:"pll-default-lang-icon"}),(0,o.jsx)("span",{className:"screen-reader-text",children:(0,d.__)("Default language.","polylang-pro")})]}),h=({sidebar:t,sidebarName:n,onPromise:s,children:r})=>(s().then((()=>{(0,e.registerPlugin)(n,{icon:l,render:t})}),(t=>{console.info(t)})),(0,o.jsx)(o.Fragment,{children:r}));var f=n(601),m=n(987);const y="pll/metabox",w="core/editor",_="core/edit-site",v="core",x={languages:[],selectedLanguage:{},translatedPosts:{},fromPost:null,currentTemplatePart:{}},b=["wp_template","wp_global_styles"],j=["page"],S="___";var P=n(419),T=n(172);function E(t){const e={};return t.forEach((function(t,e){this[e]=(0,P.isBoolean)(t)?t.toString():t}),e),e}function C(t){const e=(0,m.select)(y).getLanguages();return e?e.get(t):null}function N(){const t=(0,m.select)(y).getLanguages();return Array.from(t.values()).find((t=>t.is_default))}function O(t){let e=new Map(Object.entries([]));return(0,P.isUndefined)(t)||(e=new Map(Object.entries(t))),e}function L(t){let e=new Map(Object.entries([]));return(0,P.isUndefined)(t)||(e=new Map(Object.entries(t))),e}function k(t,e){const n=(0,T.hasQueryArg)(t.path,"lang");((0,P.isUndefined)(t.filterLang)||t.filterLang)&&!n&&(t.path=(0,T.addQueryArgs)(t.path,{lang:e}))}function R(t){const e=new URL(document.location).searchParams,n=e.get("postType"),s=e.get("postId"),o=(0,m.select)("core/edit-post")?.isEditingTemplate();("wp_template_part"===n&&!(0,P.isNil)(s)||o)&&function(t){t.path=(0,T.addQueryArgs)(t.path,{include_untranslated:!0})}(t)}function D(){return document.getElementById("site-editor")||document.getElementById("edit-site-editor")?(0,m.select)(_).getEditedPostType():(0,m.select)(w).getCurrentPostType()}const A=()=>{M(),(0,m.select)(y).getCurrentUser();const t=new Promise((function(t){const e=(0,m.subscribe)((function(){(0,m.select)(_)&&(e(),t())}))}));return Promise.all([t,U()])},U=()=>new Promise((function(t){const e=(0,m.subscribe)((function(){const n=(0,m.select)(y)?.getLanguages();n?.size>0&&(e(),t())}))}));function M(){const t=(0,P.isEmpty)(window.location.search)?null:new URLSearchParams(window.location.search);null!==t&&(0,m.dispatch)(y).setFromPost({id:wp.sanitize.stripTagsAndEncodeText(t.get("from_post")),postType:wp.sanitize.stripTagsAndEncodeText(t.get("post_type")),newLanguage:wp.sanitize.stripTagsAndEncodeText(t.get("new_lang"))})}const F=()=>{const t=(()=>{const t=(0,m.select)(_);if(!t)return null;const e={postId:t.getEditedPostId(),postType:t.getEditedPostType()};if(t.hasOwnProperty("getEditedPostContext")){const n=t.getEditedPostContext();return n?.postType&&n?.postId?n:e}return e})();return null===t?null:(0,m.select)(v).getEntityRecord("postType",t.postType,t.postId)},I=({onPromise:t})=>{const e=(0,f.useRef)({}),n=()=>{var t;const e=F();return null!==(t=C(e?.lang))&&void 0!==t?t:"default"};return(0,f.useEffect)((()=>{const s=t=>{if(e.current=n(),e?.current.is_default||"default"===e?.current)return;const s=new URL(document.location.href).searchParams,o=new URL(t).searchParams;s.get("postId")!==o.get("postId")&&(0,m.dispatch)(v).invalidateResolutionForStore()};t().then((()=>{e.current=n()})),(t=>{const e=t.pushState,n=t.replaceState;t.pushState=(n,o,r)=>(s(r),e.apply(t,[n,o,r])),t.replaceState=(e,o,r)=>(s(r),n.apply(t,[e,o,r]))})(window.history)}),[t]),null},z=({SidebarSlot:t,MoreMenuItemSlot:e,sidebarName:n,children:s})=>{const r=(0,d.__)("Languages","polylang-pro");return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t,{name:n,title:r,children:s}),(0,o.jsx)(e,{target:n,children:r})]})};const B=function({language:t}){return(0,P.isNil)(t)?(0,o.jsx)("span",{className:"pll-translation-icon",children:l}):(0,P.isEmpty)(t.flag_url)?(0,o.jsxs)("abbr",{children:[t.slug,(0,o.jsx)("span",{className:"screen-reader-text",children:t.name})]}):(0,o.jsx)("span",{className:"pll-select-flag",children:(0,o.jsx)("img",{src:t.flag_url,alt:t.name,title:t.name,className:"flag"})})};const V=({language:t,currentPost:e})=>{var n;const s=(0,m.useSelect)((t=>t(v).getPostType(e.type)),[e]);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("p",{children:(0,o.jsx)("strong",{children:(0,d.__)("Language","polylang-pro")})}),(0,o.jsxs)("div",{className:"pll-language-item",children:[(0,o.jsx)(B,{language:t}),(0,o.jsx)("span",{className:"pll-language-name",children:t.name}),t.is_default&&(0,o.jsx)(g,{})]}),t.is_default&&(0,o.jsx)("div",{children:(0,o.jsx)("span",{className:"pll-metabox-info",children:null!==(n="wp_template_part"===s?.slug)&&void 0!==n?n:(0,d.__)("This template part is used for languages that have not yet been translated.","polylang-pro")})})]})},W=({children:t})=>(0,o.jsx)("div",{className:"components-panel__body is-opened",children:(0,o.jsx)("div",{className:"pll-metabox-location",children:t})}),$=({postType:t})=>"wp_template"===t?(0,o.jsx)("div",{className:"pll-metabox-error components-notice is-warning",children:(0,d.__)("Templates are not translatable, only template parts are.","polylang-pro")}):(0,o.jsx)("div",{className:"pll-metabox-error components-notice is-warning",children:(0,d.__)("This entity is not translatable.","polylang-pro")}),H=({isError:t,isAllowedPostType:e,postType:n,children:s})=>e?t?(0,o.jsx)(W,{children:(0,o.jsx)("div",{className:"pll-metabox-error components-notice is-error",children:(0,d.__)("Unable to retrieve the content language","polylang-pro")})}):(0,o.jsx)(W,{children:s}):(0,o.jsx)(W,{children:(0,o.jsx)($,{postType:n})}),G=({children:t})=>(0,o.jsx)("td",{className:"pll-edit-column pll-column-icon",children:t}),K=({isDefault:t})=>(0,o.jsx)("td",{className:"pll-default-lang-column pll-column-icon",children:t&&(0,o.jsx)(g,{})}),q=({children:t})=>(0,o.jsx)("td",{className:"pll-delete-column pll-column-icon",children:t}),Q=({language:t})=>(0,o.jsx)("th",{className:"pll-language-column",children:(0,P.isEmpty)(t.flag)?(0,o.jsxs)("abbr",{children:[t.slug,(0,o.jsx)("span",{className:"screen-reader-text",children:t.name})]}):(0,o.jsx)("span",{className:"pll-select-flag flag",children:(0,o.jsx)("img",{src:t.flag_url,alt:t.name,title:t.name})})}),Y=({children:t})=>(0,o.jsx)("td",{className:"pll-translation-column",children:t}),X=({language:t,href:e,handleAddClick:n=null})=>{const s=(0,d.sprintf)((0,d.__)("Add a translation in %s","polylang-pro"),t.name);return(0,o.jsx)(u.Button,{href:e,icon:a,label:s,className:"pll-button",onClick:n,"data-target-language":t.slug,children:(0,o.jsx)("span",{className:"screen-reader-text",children:s})})},J=({language:t,disabled:e,onClick:n})=>{const s=(0,d.sprintf)((0,d.__)("Delete the translation in %s","polylang-pro"),t.name);return(0,o.jsx)(u.Button,{icon:c,label:s,disabled:e,className:"pll-button",onClick:n,children:(0,o.jsx)("span",{className:"screen-reader-text",children:s})})},Z=({language:t,href:e,handleEditClick:n=null})=>{const s=(0,d.sprintf)((0,d.__)("Edit the translation in %s","polylang-pro"),t.name);return(0,o.jsx)(u.Button,{href:e,icon:r,label:s,className:"pll-button",onClick:n,"data-target-language":t.slug,children:(0,o.jsx)("span",{className:"screen-reader-text",children:s})})};var tt=n(897);class et extends f.Component{constructor(){super(...arguments),this.confirmButton=(0,f.createRef)()}componentDidMount(){this.confirmButton.current.focus()}render(){const{idPrefix:t,title:e,updateState:n,handleChange:s,children:r}=this.props;return(0,o.jsxs)(u.Modal,{title:e,className:"confirmBox",onRequestClose:n,shouldCloseOnEsc:!1,shouldCloseOnClickOutside:!1,focusOnMount:!1,children:[r,(0,o.jsxs)(u.ButtonGroup,{className:"buttons",children:[(0,o.jsx)(u.Button,{id:`${t}_confirm`,ref:this.confirmButton,isPrimary:!0,onClick:t=>{s(t),n()},children:(0,d.__)("OK","polylang-pro")}),(0,o.jsx)(u.Button,{id:`${t}_cancel`,isSecondary:!0,onClick:()=>n(),children:(0,d.__)("Cancel","polylang-pro")})]})]})}}const nt=function(t,e,n){return(0,tt.createHigherOrderComponent)((s=>{class r extends f.Component{constructor(){super(...arguments),this.state={isOpen:!1,changeValue:null},this.handleChange=this.handleChange.bind(this)}handleChange(t){let e=s.getChangeValue(t);const o=this.props.currentPost;(0,P.isNil)(o)||(e={templateId:e,currentPost:o}),!(0,P.isUndefined)(s.bypassConfirmation)&&s.bypassConfirmation(this.props.translationData)?n(e):this.setState({isOpen:!0,changeValue:e})}render(){const r=this.props.translationData?.lang.is_default,a=this.props,i=Object.assign({},{...a},{handleChange:this.handleChange});return(0,o.jsxs)(f.Fragment,{children:[(0,o.jsx)(s,{...i}),this.state.isOpen&&(0,o.jsx)(et,{title:s.labelConfirmationModal,idPrefix:t,handleChange:()=>n(this.state.changeValue),updateState:()=>this.setState({isOpen:!1,changeValue:null}),children:(0,o.jsx)(e,{...(0,P.isNil)(r)?{}:{isDefaultLang:r}})})]})}}return r.bypassConfirmation=s.bypassConfirmation,r.getChangeValue=s.getChangeValue,r}),"withConfirmation")};class st extends f.Component{static handleSynchronizationChange(t){const e=O((0,m.select)(w).getEditedPostAttribute("pll_sync_post"));e.has(t)?e.delete(t):e.set(t,!0),(0,m.dispatch)(w).editPost({pll_sync_post:E(e)}),(0,m.dispatch)(w).editPost({title:(0,m.select)(w).getEditedPostAttribute("title")})}static bypassConfirmation(t){const e=O((0,m.select)(w).getEditedPostAttribute("pll_sync_post")),n=!(0,P.isEmpty)(e)&&e.has(t.lang.slug),s=!(0,P.isUndefined)(t.translated_post)&&!(0,P.isNil)(t.translated_post.id);return n||!s}static getChangeValue(t){return t.currentTarget.id.match(/\[(.[^[]+)\]/i)[1]}render(){const t=O((0,m.select)(w).getEditedPostAttribute("pll_sync_post")),e=this.props.translationData,n=!(0,P.isEmpty)(t)&&t.has(e.lang.slug),s=n&&"wp-ui-text-highlight",r=n?(0,d.__)("Don't synchronize this post","polylang-pro"):(0,d.__)("Synchronize this post","polylang-pro");return(0,o.jsx)(u.Button,{icon:i,label:r,id:`pll_sync_post[${e.lang.slug}]`,className:`pll-button ${s}`,onClick:t=>{this.props.handleChange(t)},children:(0,o.jsx)("span",{className:"screen-reader-text",children:r})})}}st.labelConfirmationModal=(0,d.__)("Synchronize this post","polylang-pro");nt("pll_sync_post",(function(){return(0,o.jsx)("p",{children:(0,d.__)("You are about to overwrite an existing translation. Are you sure you want to proceed?","polylang-pro")})}),st.handleSynchronizationChange)(st);var ot=n(942),rt=n.n(ot);function at(t){return at="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},at(t)}function it(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,s)}return n}function ct(t,e){var n=t["page".concat(e?"Y":"X","Offset")],s="scroll".concat(e?"Top":"Left");if("number"!=typeof n){var o=t.document;"number"!=typeof(n=o.documentElement[s])&&(n=o.body[s])}return n}function pt(t){return ct(t)}function ut(t){return ct(t,!0)}function dt(t){var e=function(t){var e,n,s,o=t.ownerDocument,r=o.body,a=o&&o.documentElement;return n=(e=t.getBoundingClientRect()).left,s=e.top,{left:n-=a.clientLeft||r.clientLeft||0,top:s-=a.clientTop||r.clientTop||0}}(t),n=t.ownerDocument,s=n.defaultView||n.parentWindow;return e.left+=pt(s),e.top+=ut(s),e}var gt,ht=new RegExp("^(".concat(/[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source,")(?!px)[a-z%]+$"),"i"),ft=/^(top|right|bottom|left)$/,mt="currentStyle",yt="runtimeStyle",wt="left";function _t(t,e){for(var n=0;n<t.length;n++)e(t[n])}function vt(t){return"border-box"===gt(t,"boxSizing")}"undefined"!=typeof window&&(gt=window.getComputedStyle?function(t,e,n){var s="",o=t.ownerDocument,r=n||o.defaultView.getComputedStyle(t,null);return r&&(s=r.getPropertyValue(e)||r[e]),s}:function(t,e){var n=t[mt]&&t[mt][e];if(ht.test(n)&&!ft.test(e)){var s=t.style,o=s[wt],r=t[yt][wt];t[yt][wt]=t[mt][wt],s[wt]="fontSize"===e?"1em":n||0,n=s.pixelLeft+"px",s[wt]=o,t[yt][wt]=r}return""===n?"auto":n});var xt=["margin","border","padding"];function bt(t,e,n){var s,o,r,a=0;for(o=0;o<e.length;o++)if(s=e[o])for(r=0;r<n.length;r++){var i=void 0;i="border"===s?"".concat(s+n[r],"Width"):s+n[r],a+=parseFloat(gt(t,i))||0}return a}function jt(t){return null!=t&&t==t.window}var St={};function Pt(t,e,n){if(jt(t))return"width"===e?St.viewportWidth(t):St.viewportHeight(t);if(9===t.nodeType)return"width"===e?St.docWidth(t):St.docHeight(t);var s="width"===e?["Left","Right"]:["Top","Bottom"],o="width"===e?t.offsetWidth:t.offsetHeight,r=(gt(t),vt(t)),a=0;(null==o||o<=0)&&(o=void 0,(null==(a=gt(t,e))||Number(a)<0)&&(a=t.style[e]||0),a=parseFloat(a)||0),void 0===n&&(n=r?1:-1);var i=void 0!==o||r,l=o||a;if(-1===n)return i?l-bt(t,["border","padding"],s):a;if(i){var c=2===n?-bt(t,["border"],s):bt(t,["margin"],s);return l+(1===n?0:c)}return a+bt(t,xt.slice(n),s)}_t(["Width","Height"],(function(t){St["doc".concat(t)]=function(e){var n=e.document;return Math.max(n.documentElement["scroll".concat(t)],n.body["scroll".concat(t)],St["viewport".concat(t)](n))},St["viewport".concat(t)]=function(e){var n="client".concat(t),s=e.document,o=s.body,r=s.documentElement[n];return"CSS1Compat"===s.compatMode&&r||o&&o[n]||r}}));var Tt={position:"absolute",visibility:"hidden",display:"block"};function Et(t){var e,n=arguments;return 0!==t.offsetWidth?e=Pt.apply(void 0,n):function(t,e,n){var s,o={},r=t.style;for(s in e)e.hasOwnProperty(s)&&(o[s]=r[s],r[s]=e[s]);for(s in n.call(t),e)e.hasOwnProperty(s)&&(r[s]=o[s])}(t,Tt,(function(){e=Pt.apply(void 0,n)})),e}function Ct(t,e,n){var s=n;if("object"!==at(e))return void 0!==s?("number"==typeof s&&(s+="px"),void(t.style[e]=s)):gt(t,e);for(var o in e)e.hasOwnProperty(o)&&Ct(t,o,e[o])}_t(["width","height"],(function(t){var e=t.charAt(0).toUpperCase()+t.slice(1);St["outer".concat(e)]=function(e,n){return e&&Et(e,t,n?0:1)};var n="width"===t?["Left","Right"]:["Top","Bottom"];St[t]=function(e,s){if(void 0===s)return e&&Et(e,t,-1);if(e){gt(e);return vt(e)&&(s+=bt(e,["padding","border"],n)),Ct(e,t,s)}}}));var Nt=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?lt(n,!0).forEach((function(e){it(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):lt(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({getWindow:function(t){var e=t.ownerDocument||t;return e.defaultView||e.parentWindow},offset:function(t,e){if(void 0===e)return dt(t);!function(t,e){"static"===Ct(t,"position")&&(t.style.position="relative");var n,s,o=dt(t),r={};for(s in e)e.hasOwnProperty(s)&&(n=parseFloat(Ct(t,s))||0,r[s]=n+e[s]-o[s]);Ct(t,r)}(t,e)},isWindow:jt,each:_t,css:Ct,clone:function(t){var e={};for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);if(t.overflow)for(var s in t)t.hasOwnProperty(s)&&(e.overflow[s]=t.overflow[s]);return e},scrollLeft:function(t,e){if(jt(t)){if(void 0===e)return pt(t);window.scrollTo(e,ut(t))}else{if(void 0===e)return t.scrollLeft;t.scrollLeft=e}},scrollTop:function(t,e){if(jt(t)){if(void 0===e)return ut(t);window.scrollTo(pt(t),e)}else{if(void 0===e)return t.scrollTop;t.scrollTop=e}},viewportWidth:0,viewportHeight:0},St);const Ot=function(t,e,n){n=n||{},9===e.nodeType&&(e=Nt.getWindow(e));var s=n.allowHorizontalScroll,o=n.onlyScrollIfNeeded,r=n.alignWithTop,a=n.alignWithLeft,i=n.offsetTop||0,l=n.offsetLeft||0,c=n.offsetBottom||0,p=n.offsetRight||0;s=void 0===s||s;var u,d,g,h,f,m,y,w,_,v,x=Nt.isWindow(e),b=Nt.offset(t),j=Nt.outerHeight(t),S=Nt.outerWidth(t);x?(y=e,v=Nt.height(y),_=Nt.width(y),w={left:Nt.scrollLeft(y),top:Nt.scrollTop(y)},f={left:b.left-w.left-l,top:b.top-w.top-i},m={left:b.left+S-(w.left+_)+p,top:b.top+j-(w.top+v)+c},h=w):(u=Nt.offset(e),d=e.clientHeight,g=e.clientWidth,h={left:e.scrollLeft,top:e.scrollTop},f={left:b.left-(u.left+(parseFloat(Nt.css(e,"borderLeftWidth"))||0))-l,top:b.top-(u.top+(parseFloat(Nt.css(e,"borderTopWidth"))||0))-i},m={left:b.left+S-(u.left+g+(parseFloat(Nt.css(e,"borderRightWidth"))||0))+p,top:b.top+j-(u.top+d+(parseFloat(Nt.css(e,"borderBottomWidth"))||0))+c}),f.top<0||m.top>0?!0===r?Nt.scrollTop(e,h.top+f.top):!1===r?Nt.scrollTop(e,h.top+m.top):f.top<0?Nt.scrollTop(e,h.top+f.top):Nt.scrollTop(e,h.top+m.top):o||((r=void 0===r||!!r)?Nt.scrollTop(e,h.top+f.top):Nt.scrollTop(e,h.top+m.top)),s&&(f.left<0||m.left>0?!0===a?Nt.scrollLeft(e,h.left+f.left):!1===a?Nt.scrollLeft(e,h.left+m.left):f.left<0?Nt.scrollLeft(e,h.left+f.left):Nt.scrollLeft(e,h.left+m.left):o||((a=void 0===a||!!a)?Nt.scrollLeft(e,h.left+f.left):Nt.scrollLeft(e,h.left+m.left)))};var Lt=n(860),kt=n(631),Rt=n.n(kt);const Dt=({value:t,post:e=null,translatedPosts:n,translationData:s,language:o})=>{(0,P.isEmpty)(e)?(s.translated_post={id:null,title:t},s.links={add_link:s.links.add_link},n.delete(o.slug)):(n.set(o.slug,e.id),s.translated_post={id:e.id,title:e.title.raw},s.block_editor={edit_link:e.block_editor.edit_link},s.caps=e.caps),(0,m.dispatch)(w).editPost({translations:E(n)}),(0,m.dispatch)(w).editPost({title:(0,m.select)(w).getEditedPostAttribute("title")})},At=t=>t.stopPropagation();class Ut extends f.Component{constructor(){super(...arguments),this.onChange=this.onChange.bind(this),this.onKeyDown=this.onKeyDown.bind(this),this.bindListNode=this.bindListNode.bind(this),this.updateSuggestions=(0,P.debounce)(this.updateSuggestions.bind(this),500),this.suggestionNodes=[],this.state={posts:[],showSuggestions:!1,selectedSuggestion:null}}componentDidUpdate(){const{showSuggestions:t,selectedSuggestion:e}=this.state;t&&null!==e&&!this.scrollingIntoView&&(this.scrollingIntoView=!0,Ot(this.suggestionNodes[e],this.listNode,{onlyScrollIfNeeded:!0}),setTimeout((()=>{this.scrollingIntoView=!1}),100))}componentWillUnmount(){delete this.suggestionsRequest}bindListNode(t){this.listNode=t}bindSuggestionNode(t){return e=>{this.suggestionNodes[t]=e}}updateSuggestions(t,e=!1){if(t.length<2&&!e)return void this.setState({showSuggestions:!1,selectedSuggestion:null,loading:!1});this.setState({selectedSuggestion:null,loading:!0});const n=(0,m.select)(w).getCurrentPostId(),s=(0,m.select)(w).getCurrentPostType(),o=(0,m.select)(w).getEditedPostAttribute("lang"),r=this.props.translationData.lang.slug,a=Rt()({path:(0,T.addQueryArgs)("/pll/v1/untranslated-posts",{search:t,include:n,untranslated_in:o,lang:r,type:s,context:"edit"})});a.then((t=>{this.suggestionsRequest===a&&(this.setState({posts:t,showSuggestions:!0,loading:!1}),t.length?this.props.debouncedSpeak((0,d.sprintf)((0,d._n)("%d result found, use up and down arrow keys to navigate.","%d results found, use up and down arrow keys to navigate.",t.length,"polylang-pro"),t.length),"assertive"):this.props.debouncedSpeak((0,d.__)("No results.","polylang-pro"),"assertive"))})).catch((()=>{this.suggestionsRequest===a&&this.setState({loading:!1})})),this.suggestionsRequest=a}onChange(t){const e=t.target.value,n=this.props.translatedPosts,s=this.props.translationData,o=this.props.translationData.lang;Dt({value:e,translatedPosts:n,translationData:s,language:o}),this.updateSuggestions(e)}onKeyDown(t){const{showSuggestions:e,selectedSuggestion:n,posts:s,loading:o}=this.state;let r=t.target.value,a=!1;if(e&&s.length&&!o)switch(t.keyCode){case Lt.UP:{t.stopPropagation(),t.preventDefault();const e=n?n-1:s.length-1;this.setState({selectedSuggestion:e});break}case Lt.DOWN:{t.stopPropagation(),t.preventDefault();const e=null===n||n===s.length-1?0:n+1;this.setState({selectedSuggestion:e});break}case Lt.ENTER:if(null!==this.state.selectedSuggestion){t.stopPropagation();const e=this.state.posts[this.state.selectedSuggestion];this.selectLink(e)}break;case Lt.ESCAPE:t.stopPropagation(),this.setState({selectedSuggestion:null,showSuggestions:!1})}else{switch(t.keyCode){case Lt.SPACE:const{ctrlKey:e,shiftKey:n,altKey:s,metaKey:o}=t;e&&!(n||s||o)&&(r="",a=!0);break;case Lt.BACKSPACE:(0,P.isEmpty)(r)&&(a=!0)}a&&this.updateSuggestions(r,!0)}}selectLink(t){const e=this.props.translationData,n=this.props.translatedPosts,s=this.props.translationData.lang;Dt({value:t.title.raw,post:t,translatedPosts:n,translationData:e,language:s}),this.setState({selectedSuggestion:null,showSuggestions:!1})}render(){const{value:t="",autoFocus:e=!0,instanceId:n,translationData:s}=this.props,r=s.lang,{showSuggestions:a,posts:i,selectedSuggestion:l,loading:c}=this.state,p=s.caps.edit||s.caps.add;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("label",{className:"screen-reader-text",htmlFor:`tr_lang_${s.lang.slug}`,children:(0,d.__)("Translation","polylang-pro")}),(0,o.jsxs)("div",{className:"translation-input",children:[(0,o.jsx)("input",{lang:r.w3c,dir:r.is_rtl?"rtl":"ltr",style:{direction:r.is_rtl?"rtl":"ltr"},autoFocus:e,disabled:!p,type:"text","aria-label":(0,d.__)("URL","polylang-pro"),required:!0,value:t,onChange:this.onChange,onInput:At,placeholder:(0,d.__)("Start typing the post title","polylang-pro"),onKeyDown:this.onKeyDown,role:"combobox","aria-expanded":a,"aria-autocomplete":"list","aria-owns":`translation-input-suggestions-${n}`,"aria-activedescendant":null!==l?`translation-input-suggestion-${n}-${l}`:void 0}),c&&(0,o.jsx)(u.Spinner,{})]}),a&&!!i.length&&(0,o.jsx)(u.Popover,{position:"bottom",noArrow:!0,focusOnMount:!1,children:(0,o.jsx)("div",{className:"translation-input__suggestions",id:`translation-input-suggestions-${n}`,ref:this.bindListNode,role:"listbox",children:i.map(((t,e)=>(0,o.jsx)("button",{role:"option",tabIndex:"-1",id:`translation-input-suggestion-${n}-${e}`,ref:this.bindSuggestionNode(e),className:rt()("translation-input__suggestion",{"is-selected":e===l}),onClick:()=>this.selectLink(t),"aria-selected":e===l,children:t.title.raw||(0,d.__)("(no title)","polylang-pro")},t.id)))})})]})}}(0,u.withSpokenMessages)((0,tt.withInstanceId)(Ut));const Mt=({language:t,children:e})=>(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(Q,{language:t}),e]}),Ft=({children:t})=>(0,o.jsxs)("div",{id:"post-translations",className:"translations",children:[(0,o.jsx)("p",{children:(0,o.jsx)("strong",{children:(0,d.__)("Translations","polylang-pro")})}),(0,o.jsx)("table",{children:(0,o.jsx)("tbody",{children:t})})]}),It=({isDefaultLang:t})=>(0,o.jsxs)(o.Fragment,{children:[t?(0,o.jsxs)("p",{children:[(0,d.__)("You are about to delete an entity in the default language.","polylang-pro"),(0,o.jsx)("br",{}),(0,d.__)("This will delete its customizations and all its corresponding translations.","polylang-pro")]}):null,(0,o.jsx)("p",{children:(0,d.__)("Are you sure you want to delete this translation?","polylang-pro")})]});var zt=n(488),Bt=n(672);const Vt=()=>{const{deleteEntityRecord:t}=(0,m.useDispatch)(zt.store),{createSuccessNotice:e,createErrorNotice:n}=(0,m.useDispatch)(Bt.store);return{handleDelete:async(s,o)=>{try{const n=!j.includes(o);await t("postType",o,s,{force:n},{throwOnError:!0}),e((0,d.__)("The translation has been deleted.","polylang-pro"),{type:"snackbar"})}catch(t){n((0,d.sprintf)((0,d.__)("Unable to delete the translation. %s","polylang-pro"),t?.message),{type:"snackbar"})}}}},Wt=(t,e)=>{if(!t.is_default||"page"===e)return;const n=window.location.origin+wp.sanitize.stripTags(window.location.pathname),s={};switch(e){case"wp_navigation":s.path="/navigation";break;case"wp_block":s.path="/patterns",s.categoryType=e;break;case"wp_template_part":s.path="/"+e+"/all"}location.href=(0,T.addQueryArgs)(n,s)},$t=({translationData:t,postType:e,onDeleteSuccess:n})=>{const[s,r]=(0,f.useState)(!1),a=()=>r(!1),i=void 0!==t.translated_post?.id&&null!==t.translated_post?.id,l=t.caps.delete,{handleDelete:c}=Vt();return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(J,{onClick:()=>r(!0),language:t.lang,disabled:!i||!l}),s&&(0,o.jsxs)(u.Modal,{title:"Delete",onRequestClose:a,children:[(0,o.jsx)(It,{isDefaultLang:t.lang.is_default&&"page"!==e}),(0,o.jsxs)("div",{role:"group",className:"components-button-group buttons",children:[(0,o.jsx)(u.Button,{variant:"tertiary",onClick:a,type:"button",children:(0,d.__)("Cancel","polylang-pro")}),(0,o.jsx)("span",{children:" "}),(0,o.jsx)(u.Button,{variant:"primary",onClick:()=>{const s="wp_template_part"===e&&void 0!==t.template?t.template.id:t.translated_post.id;c(s,e).then((()=>n())),a(),Wt(t.lang,e)},type:"submit",children:(0,d.__)("Delete","polylang-pro")})]})]})]})},Ht=()=>{const{saveEntityRecord:t}=(0,m.useDispatch)(zt.store),{createSuccessNotice:e,createErrorNotice:n}=(0,m.useDispatch)(Bt.store);return{handleCreateTranslation:async(s,o)=>{const r={title:o.title.raw,content:o.content.raw,lang:s,from_post:o.id,translations:o.translations,status:o.status};if("wp_template_part"===o.type){const t=function(){let t="[a-z][a-z0-9_-]*";const e=(0,m.select)(y).getLanguages(),n=Array.from(e.keys());return(0,P.isEmpty)(n)||(t=n.join("|")),new RegExp(`___(?:${t})$`)}(),e=o.slug.replace(t,""),n={[o.lang]:o.wp_id};r.slug=e,r.area=o.area,r.from_post=o.wp_id,r.translations=n}try{const n=await t("postType",o.type,r,{throwOnError:!0});e((0,d.__)("The translation is created, you will be redirected.","polylang-pro"),{type:"snackbar"});const a=n.translations_table[s]?.site_editor.edit_link;void 0!==a&&(location.href=a)}catch(t){const e=t.message&&"unknown_error"!==t.code?t.message:(0,d.__)("An error occurred while creating the translation.","polylang-pro");n(e,{type:"snackbar"})}}}},Gt=({translationsTable:t,currentPost:e,translationsTableDispatch:n})=>{const{handleCreateTranslation:s}=Ht(),r=Array.from(t.values()).map((t=>{if(e?.lang===t.lang.slug)return null;const r=void 0!==t.translated_post?.id&&null!==t.translated_post?.id,a=t.caps.edit,i="wp_template_part"===e.type&&!e.wp_id||t.caps.add;return(0,o.jsx)("tr",{children:(0,o.jsxs)(Mt,{language:t.lang,children:[(0,o.jsx)(Y,{children:(0,o.jsx)("span",{className:"pll-translation-language",children:t.lang.name})}),(0,o.jsx)(G,{children:(()=>{if(r&&a)return(0,o.jsx)(Z,{href:decodeURI(t.site_editor.edit_link),language:t.lang});if(i){const n=()=>{s(t.lang.slug,e)};return(0,o.jsx)(X,{href:"#",language:t.lang,handleAddClick:n})}return null})()}),(0,o.jsx)(q,{children:(0,o.jsx)($t,{translationData:t,postType:e.type,onDeleteSuccess:function(){n({type:"remove_translation",lang:t.lang.slug})}})}),(0,o.jsx)(K,{isDefault:t.lang.is_default})]})},t.lang.slug)}));return(0,o.jsx)(Ft,{children:r})},Kt=(t,e)=>{switch(e.type){case"remove_translation":return delete t.get(e.lang).translated_post,new Map(t);case"set_table":return e.table;default:return t}},qt=()=>{const[t,e]=(0,f.useReducer)(Kt,new Map),[n,s]=(0,f.useState)({}),[r,a]=(0,f.useState)({}),[i,l]=(0,f.useState)("");return(0,f.useEffect)((()=>{let t;if("/wp_global_styles"===wp.sanitize.stripTagsAndEncodeText((0,T.getQueryArg)(window.location.href,"path"))&&(t="wp_global_styles"),"wp_template"===wp.sanitize.stripTagsAndEncodeText((0,T.getQueryArg)(window.location.href,"postType"))&&(t="wp_template"),t)return void l(t);const n=F();s(n),l(n?.type);const o=C(n?.lang);a(o),e({type:"set_table",table:L(n?.translations_table)})}),[s,l,a,e]),(0,o.jsxs)(H,{isError:!r,isAllowedPostType:!b.includes(i),postType:i,children:[(0,o.jsx)(V,{language:r,currentPost:n}),(0,o.jsx)(Gt,{translationsTable:t,currentPost:n,translationsTableDispatch:e})]})},Qt={setLanguages:t=>({type:"SET_LANGUAGES",languages:t}),setCurrentUser:(t,e=!1)=>({type:"SET_CURRENT_USER",currentUser:t,save:e}),setFromPost:t=>({type:"SET_FROM_POST",fromPost:t}),fetchFromAPI:t=>({type:"FETCH_FROM_API",options:t})},Yt=(0,m.createReduxStore)(y,{reducer(t=x,e){switch(e.type){case"SET_LANGUAGES":return{...t,languages:e.languages};case"SET_CURRENT_USER":return e.save&&(n=e.currentUser,Promise.resolve(Rt()({path:"/wp/v2/users/me",data:n,method:"POST"}))).then((n=>(e.currentUser=n,{...t,currentUser:e.currentUser}))),{...t,currentUser:e.currentUser};case"SET_FROM_POST":return{...t,fromPost:e.fromPost};case"SET_CURRENT_TEMPLATE_PART":return{...t,currentTemplatePart:e.currentTemplatePart};default:return t}var n},selectors:{getLanguages:t=>t.languages,getCurrentUser:t=>t.currentUser,getFromPost:t=>t.fromPost},actions:Qt,controls:{FETCH_FROM_API:t=>Rt()({...t.options})},resolvers:{*getLanguages(){const t=yield Qt.fetchFromAPI({path:"/pll/v1/languages",filterLang:!1});return Qt.setLanguages(function(t,e){const n=new Map;return t.reduce((function(t,n){return t.set(n[e],n),t}),n),n}(t,"slug"))},*getCurrentUser(){const t=yield Qt.fetchFromAPI({path:"/wp/v2/users/me",filterLang:!0});return Qt.setCurrentUser(t)}}});(0,m.register)(Yt);const Xt=(t,e,n)=>{const s=t.path.split("?")[0].replace(/^\/+|\/+$/g,"");return Object.values(e).find((t=>s===t))?n(t):t};(t=>{Rt().use(((e,n)=>void 0!==e.url||"undefined"==typeof pllFilteredRoutes?n(e):n(Xt(e,pllFilteredRoutes,t))))})((function(t){const e=function(){if((0,P.isUndefined)((0,m.select)(w)))return pll_block_editor_plugin_settings.lang.slug;const t=(0,m.select)(w).getEditedPostAttribute("lang");if(!(0,P.isUndefined)(t)&&t)return t;const e=new URL(document.location).searchParams,n=e.get("postType"),s=e.get("postId");if("wp_template_part"===n&&(0,P.isNil)(s))return pll_block_editor_plugin_settings.lang=N(),pll_block_editor_plugin_settings.lang.slug;const o=F(),r=o?.lang;if(!(0,P.isUndefined)(r)&&r)return r;return pll_block_editor_plugin_settings.lang.slug}();return function(t){return!(0,P.isNil)(t.data)}(t)?(function(t){return"POST"===t.method&&t.path.match(/^\/wp\/v2\/template-parts(?:\/|\?|$)/)&&(0,P.isNil)(t.data.from_post)&&(0,P.isNil)(t.data.lang)}(t)&&k(t,N()?.slug),function(t){const e=(0,P.map)((0,m.select)("core").getEntitiesConfig("postType"),(0,P.property)("baseURL")),n=(0,m.select)("core/editor").getCurrentPostId(),s=t.data.id;return-1!==e.findIndex((function(e){return new RegExp(`${(0,P.escapeRegExp)(e)}`).test(t.path)}))&&n===s}(t)||function(t){return"POST"===t.method&&t.path.match(/^\/wp\/v2\/template-parts(?:\/|\?|$)/)&&!(0,P.isNil)(t.data.from_post)&&!(0,P.isNil)(t.data.lang)}(t)||k(t,e),function(t,e){const n=function(t){const e=(0,m.select)("core").getEntitiesConfig("postType"),n=(0,P.find)(e,{name:t});return n?.baseURL}("wp_template_part");if((0,P.isUndefined)(n))return;const s=new RegExp((0,P.escapeRegExp)(n));if("POST"===t.method&&s.test(t.path)){if(!(0,m.select)(y).getLanguages().get(e).is_default){const n=S+e;t.data.slug+=n}}}(t,e),t):("wp_template"===D()&&k(t,N()?.slug),new RegExp(/^\/wp\/v2\/template-parts\/?(?:\?.*)?$/).test(t.path)&&R(t),k(t,e),t)}));const Jt="polylang-sidebar";(t=>{const e=document.createElement("div");e.id="pll-root";const n=document.body.appendChild(e);f.createRoot?(0,f.createRoot)(n).render(t):(0,f.render)(t,n)})((0,o.jsx)(h,{sidebar:()=>(0,o.jsx)(z,{SidebarSlot:t.PluginSidebar,MoreMenuItemSlot:t.PluginSidebarMoreMenuItem,sidebarName:Jt,children:(0,o.jsx)(qt,{})}),sidebarName:Jt,onPromise:A,children:(0,o.jsx)(I,{onPromise:A})}))})(),this["polylang-pro"]={}})();