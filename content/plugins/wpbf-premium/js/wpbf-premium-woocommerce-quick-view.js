"use strict";WpbfPremium.quickView=function(u){if(wc_add_to_cart_params&&wpbf_quick_view){var s={isRequesting:!1},a=300,_={},o={addToCart:{}},t=document.querySelector(".wpbf-woo-quick-view-modal"),r=document.querySelector("#wpbf-woo-quick-view-content");if(t&&r){var c=u(t);return _.start=function(t){t.classList.add("is-loading")},_.stop=function(t){t.classList.remove("is-loading")},o.loadQuickView=function(t){var e;t.preventDefault(),s.isRequesting||(s.isRequesting=!0,t=this.dataset.product_id,_.start(e=this),u.ajax({url:wpbf_quick_view.ajaxurl,type:"GET",cache:!1,dataType:"json",data:{product_id:t,action:"wpbf_load_product_quick_view"}}).done(function(t){r.innerHTML=t.data,c.stop().fadeIn(a),r.querySelectorAll(".variations_form").forEach(function(t){u(t).wc_variation_form(),u(t).trigger("check_variations"),u(t).trigger("reset_image")}),void 0!==u.fn.wc_product_gallery&&r.querySelectorAll(".woocommerce-product-gallery").forEach(function(t){u(t).wc_product_gallery()})}).fail(function(t){console.error(p(t))}).always(function(){_.stop(e),s.isRequesting=!1}))},o.addToCart.advancedProduct=function(t){var e,a,o,r,c,i,n,d;s.isRequesting||(s.isRequesting=!0,e=t.querySelector(".single_add_to_cart_button"),_.start(e),i=(n=t.querySelector("form.cart")).querySelector('[name="add-to-cart"]'),a=n.querySelector('[name="quantity"]'),d=t.classList.contains("product-type-variable"),o=t.classList.contains("product-type-grouped"),r=i.value,(c={action:"wpbf_add_to_cart"})["add-to-cart"]=r,o?(i=n.querySelectorAll(".woocommerce-grouped-product-list-item"),c.quantity={},i.forEach(function(t){var e=t.id.replace("product-",""),t=t.querySelector("input.qty");c.quantity[e]=t?t.value:0})):(c.product_id=r,c.quantity=a?a.value:0),d&&(d=n.querySelector('[name="variation_id"]'),n=n.querySelectorAll(".variations .value select[data-attribute_name]"),c.variation_id=d?d.value:0,n.forEach(function(t){c[t.name]=t.value})),u.ajax({url:wpbf_quick_view.ajaxurl,type:"post",dataType:"json",data:c}).done(function(t){t&&("yes"===wc_add_to_cart_params.cart_redirect_after_add&&wpbf_quick_view.cart_redirect_after_add?window.location=wc_add_to_cart_params.cart_url:(t=u(o?'.product .product_type_grouped[data-product_id="'+r+'"]':'.product .add_to_cart_button[data-product_id="'+r+'"]'),u(document.body).trigger("wc_fragment_refresh"),u(document.body).trigger("added_to_cart",[{},"",t])))}).fail(function(t){console.error(p(t))}).always(function(){_.stop(e),l(),s.isRequesting=!1}))},o.addToCart.simpleProduct=function(t){var e,a,o;s.isRequesting||(s.isRequesting=!0,e=t.querySelector(".single_add_to_cart_button"),_.start(e),t=(a=t.querySelector("form.cart")).querySelector('[name="add-to-cart"]'),a=a.querySelector('[name="quantity"]'),o=t.value,u.ajax({url:wc_add_to_cart_params.wc_ajax_url.toString().replace("%%endpoint%%","add_to_cart"),type:"post",dataType:"json",data:{product_id:o,quantity:a.value}}).done(function(t){var e;t&&(t.error&&t.product_url?window.location=t.product_url:"yes"===wc_add_to_cart_params.cart_redirect_after_add&&wpbf_quick_view.cart_redirect_after_add?window.location=wc_add_to_cart_params.cart_url:(e=u('.product .add_to_cart_button[data-product_id="'+o+'"]'),u(document.body).trigger("added_to_cart",[t.fragments,t.cart_hash,e])))}).fail(function(t){console.error(p(t))}).always(function(){_.stop(e),l(),s.isRequesting=!1}))},u(document).on("click",".wpbf-woo-quick-view",o.loadQuickView),u(document).on("click",".wpbf-woo-quick-view-modal .wpbf-close",l),document.addEventListener("click",function(t){t.target.classList.contains("wpbf-woo-quick-view-modal")&&c.is(":visible")&&l()}),document.addEventListener("keyup",function(t){"Escape"!==t.key&&"Esc"!==t.key||c.is(":visible")&&l()}),u(document).on("click",".wpbf-woo-quick-view-modal-content .product:not(.product-type-external) .single_add_to_cart_button",e),{}}}function l(){c.stop().fadeOut(a,function(){r.innerHTML="",t.style.display="none"})}function e(t){t.preventDefault();var e=document.querySelector("#wpbf-woo-quick-view-content .type-product"),a=e.classList.contains("product-type-variable"),t=e.classList.contains("product-type-grouped");a||t?o.addToCart.advancedProduct(e):o.addToCart.simpleProduct(e)}function p(t){var e="Error "+t.status.toString()+" ("+t.statusText+")";return e=t.responseJSON&&t.responseJSON.data?e+": "+t.responseJSON.data:e}}(jQuery);